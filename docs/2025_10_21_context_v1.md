ğŸ§­ ChatGPA Context Snapshot v2 (Jerry-corrected)
ğŸ¯ Mission

ChatGPA turns messy student notes into adaptive study sessions.
MVP loop: upload notes â†’ summarize â†’ auto-quiz â†’ adaptive grading â†’ results.
âœ… This part aligns perfectly.

ğŸ’» Actual Stack (verified reality)
Layer	Tech	Notes
Frontend	Vite + React + TypeScript + Tailwind	Confirmed: uses vite.config.ts + React Router.
Backend	Vercel Functions	Not Next.js App Router â€” pure /api/*.ts handlers.
Database/Auth/Storage	Supabase (Postgres + Auth + Storage)	RLS enforced, linked via Supabase CLI.
Payments	Stripe, Monthly ($9), Annual ($79).
AI	Claude or GPT-5	Called through /api/summarize, /api/generate-quiz, /api/grade.

âœ… Stack now fully accurate.

ğŸ’° Pricing / Entitlements (final clarification)
Tier	Price	Description
Free	$0	1 class + 5 quizzes total
Monthly Pro	$9/month	Unlimited (fair-use)
Annual Pro	$79/year	Unlimited (fair-use)

â†’ Schema already uses tier enum (free, monthly, annual).
â†’ So: 3-tier pricing stays â€” weâ€™ll not revert to 2-tier.

ğŸ—‚ï¸ Database Tables (final)
Table	Purpose
classes	Userâ€™s study subjects.
notes	Uploaded text/PDF summaries.
quizzes	Quiz sessions (with embedded questions).
quiz_attempts	Records user answers & scores.
usage_limits	Tracks free-tier consumption counters.
subscriptions	Stripe webhook target (tier + renewal).

Removed: entitlements â†’ replaced by usage_limits + subscriptions.
Questions are embedded as jsonb inside quizzes for simplicity â€” no separate questions table in MVP.

ğŸ§± Migrations
supabase/
â”œâ”€â”€ migrations/
â”‚   â”œâ”€â”€ 20251021_chatgpa_init.sql
â”‚   â””â”€â”€ 20251021_storage_policies.sql
# optional (not yet pushed)
â”‚   â””â”€â”€ 20251021_chatgpa_patch_v1.sql  # will add validation + indexes


âœ… Two canonical, one optional patch (safe to add later).

ğŸ” RLS & Storage

Every user-owned table: user_id = auth.uid().

notes-files bucket: private, with prefix rule auth.uid()::text || '/%'.

âš™ï¸ Environment Variables
VITE_SUPABASE_URL=
VITE_SUPABASE_ANON_KEY=
SUPABASE_SERVICE_KEY=
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=
STRIPE_PRICE_CRAM=
STRIPE_PRICE_MONTHLY=
STRIPE_PRICE_ANNUAL=
OPENAI_API_KEY=        # or ANTHROPIC_API_KEY
VITE_APP_NAME=ChatGPA

ğŸ§  API Endpoints (Vercel Functions)
Route	Purpose
/api/summarize	Summarize uploaded note into bullets/key terms.
/api/generate-quiz	Generate 8â€“10 MCQs + short answers.
/api/grade	Adaptive grading + explanations.
/api/stripe/checkout	Create checkout session.
/api/stripe/webhook	Update subscriptions + usage_limits.
ğŸ§© Build Sequence

Link Supabase & push migrations
â†’ Verify no diff.

Auth + RLS smoke test
(signup â†’ class â†’ note).

Implement 3 AI endpoints
(summarize / quiz / grade).

Dashboard UI
(Classes â†’ Notes â†’ Quiz â†’ Results).

Stripe checkout & webhook
(4-tier pricing).

Free tier counter check
via usage_limits.

Adaptive feedback UI polish.

Beta validation on Reddit.

ğŸª¶ Brand Direction

Tone: calm, clear, Notion-like.
Mascot: in design discussion (optional later).
Tagline: â€œThe study system that grows with you.â€

âœ… Alignment Summary
Category	Status
Mission	âœ…
Stack	âœ… (Vite confirmed)
Schema	âœ… (usage_limits + subscriptions)
Pricing	âœ… (3-tier final)
Migrations	âœ…
Patch Migration	Optional
Frontend	âœ… (React Router, not Next)
RLS + Storage	âœ…
ğŸ“¦ Action Items (for both sides)
Task	Owner	Status
Update context_v1.md â†’ v2 (this doc)	Jerry	âœ…
Claude verifies schema parity with Supabase	Claude	ğŸ”„
Add optional patch migration (validation/indexes)	Jerry	ğŸ•
Confirm Stripe prices live in dashboard	Hai	ğŸ•