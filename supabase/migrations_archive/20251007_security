// SQL (one-time migration)
-- security_events: tiny table used for app-level rate limiting
create table if not exists public.security_events (
  id bigserial primary key,
  ip inet not null,
  bucket text not null,
  created_at timestamptz not null default now()
);
create index if not exists security_events_ip_bucket_created_idx
  on public.security_events (ip, bucket, created_at desc);
-- RLS optional (server-side uses service key). If you enable RLS, deny public.
alter table public.security_events enable row level security;
create policy "deny all" on public.security_events for all using (false);
